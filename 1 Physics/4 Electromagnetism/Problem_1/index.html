<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 1 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 1";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 1</a>
<ul class="current">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">Problem 1</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="problem-1">Problem 1</h1>
<h1 id="simulating-the-effects-of-the-lorentz-force">Simulating the Effects of the Lorentz Force</h1>
<h2 id="1-motivation">1. Motivation</h2>
<p>The Lorentz force is a crucial concept in physics that governs the motion of charged particles in electric and magnetic fields. Mathematically, the Lorentz force is given by:</p>
<div class="arithmatex">\[
\mathbf{F} = q (\mathbf{E} + \mathbf{v} \times \mathbf{B})
\]</div>
<p>where:
- <span class="arithmatex">\(\mathbf{F}\)</span> is the force acting on a particle,
- <span class="arithmatex">\(q\)</span> is the charge of the particle,
- <span class="arithmatex">\(\mathbf{E}\)</span> is the electric field,
- <span class="arithmatex">\(\mathbf{B}\)</span> is the magnetic field,
- <span class="arithmatex">\(\mathbf{v}\)</span> is the velocity of the particle.</p>
<p>This force plays a key role in a variety of systems such as particle accelerators, mass spectrometers, and plasma confinement devices. Understanding and simulating the effects of this force helps us explore particle trajectories and optimize the design of such systems.</p>
<h2 id="2-task">2. Task</h2>
<h3 id="21-exploration-of-applications">2.1 Exploration of Applications</h3>
<p>The Lorentz force governs the behavior of charged particles in several key systems:</p>
<ul>
<li>
<p><strong>Particle Accelerators:</strong> The Lorentz force is used to accelerate particles to high speeds within electric and magnetic fields. Systems like cyclotrons and linear accelerators rely on this force to control particle motion and increase their energy.</p>
</li>
<li>
<p><strong>Mass Spectrometers:</strong> The magnetic field in a mass spectrometer applies the Lorentz force to charged particles to separate them based on their mass-to-charge ratio.</p>
</li>
<li>
<p><strong>Plasma Confinement:</strong> In fusion reactors and magnetic confinement devices (e.g., Tokamaks), the Lorentz force helps contain plasma by guiding the motion of charged particles within a magnetic field.</p>
</li>
</ul>
<p>The electric field <span class="arithmatex">\(\mathbf{E}\)</span> and magnetic field <span class="arithmatex">\(\mathbf{B}\)</span> influence the motion of the particle in distinct ways:
- The electric field directly accelerates the particle along its direction.
- The magnetic field causes the particle to move in circular or helical trajectories, depending on the initial velocity.</p>
<h3 id="22-simulating-particle-motion">2.2 Simulating Particle Motion</h3>
<p>The goal of this task is to implement a simulation to compute and visualize the trajectory of a charged particle under various field configurations. We will simulate three key scenarios:</p>
<ol>
<li>
<p><strong>Uniform Magnetic Field</strong>: The particle experiences only a magnetic field, resulting in a circular motion (if velocity is perpendicular to the magnetic field).</p>
</li>
<li>
<p><strong>Combined Uniform Electric and Magnetic Fields</strong>: The particle is subject to both electric and magnetic fields, leading to helical motion.</p>
</li>
<li>
<p><strong>Crossed Electric and Magnetic Fields</strong>: In this configuration, the electric and magnetic fields are perpendicular to each other, producing drift motion.</p>
</li>
</ol>
<p>We will use numerical methods such as the Euler method or Runge-Kutta method to solve the equations of motion. Below is a Python code that simulates the particle's motion under the effect of the Lorentz force.</p>
<h3 id="23-python-code">2.3 Python Code</h3>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Constants
q = 1.6e-19  # Charge (Coulombs, e.g., electron)
m = 9.1e-31  # Mass (kg, e.g., electron)
dt = 1e-9    # Time step (s)

# Lorentz force function: F = q(E + v x B)
def lorentz_force(r, v, E, B):
    F = q * (E + np.cross(v, B))
    return F / m  # Acceleration (F = ma)

# RK4 solver for position and velocity
def rk4_step(r, v, E, B):
    # Position update
    k1_r = v
    k1_v = lorentz_force(r, v, E, B)

    k2_r = v + 0.5 * dt * k1_v
    k2_v = lorentz_force(r + 0.5 * dt * k1_r, v + 0.5 * dt * k1_v, E, B)

    k3_r = v + 0.5 * dt * k2_v
    k3_v = lorentz_force(r + 0.5 * dt * k2_r, v + 0.5 * dt * k2_v, E, B)

    k4_r = v + dt * k3_v
    k4_v = lorentz_force(r + dt * k3_r, v + dt * k3_v, E, B)

    r_new = r + (dt / 6.0) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)
    v_new = v + (dt / 6.0) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    return r_new, v_new

# Simulation function
def simulate_trajectory(r0, v0, E, B, t_max):
    r = np.array(r0, dtype=float)
    v = np.array(v0, dtype=float)
    positions = [r.copy()]
    velocities = [v.copy()]
    t = 0

    while t &lt; t_max:
        r, v = rk4_step(r, v, E, B)
        positions.append(r.copy())
        velocities.append(v.copy())
        t += dt

    return np.array(positions), np.array(velocities)

# Plotting function
def plot_trajectory(positions, title, is_3d=True):
    if is_3d:
        fig = plt.figure(figsize=(8, 6))
        ax = fig.add_subplot(111, projection='3d')
        ax.plot(positions[:, 0], positions[:, 1], positions[:, 2])
        ax.set_xlabel('X (m)')
        ax.set_ylabel('Y (m)')
        ax.set_zlabel('Z (m)')
    else:
        plt.figure(figsize=(8, 6))
        plt.plot(positions[:, 0], positions[:, 1])
        plt.xlabel('X (m)')
        plt.ylabel('Y (m)')
    plt.title(title)
    plt.grid(True)
    plt.show()

# Case 1: Uniform Magnetic Field (B along z-axis)
B = np.array([0, 0, 1.0])  # Tesla
E = np.array([0, 0, 0])    # V/m
r0 = [0, 0, 0]             # Initial position
v0 = [1e5, 0, 0]          # Initial velocity (m/s)
t_max = 1e-7               # Simulation time (s)

pos, vel = simulate_trajectory(r0, v0, E, B, t_max)
plot_trajectory(pos, "Uniform Magnetic Field (Circular Motion)")

# Case 2: Combined Electric and Magnetic Fields
E = np.array([0, 1e5, 0])  # Electric field in y-direction
pos, vel = simulate_trajectory(r0, v0, E, B, t_max)
plot_trajectory(pos, "Combined E and B Fields (Helical Motion)")

# Case 3: Crossed Fields (E perpendicular to B)
E = np.array([0, 1e5, 0])  # E in y-direction
B = np.array([0, 0, 1.0])  # B in z-direction
v0 = [1e5, 0, 0]          # Velocity in x-direction
pos, vel = simulate_trajectory(r0, v0, E, B, t_max)
plot_trajectory(pos, "Crossed E and B Fields (Drift Motion)")
</code></pre>
<p><img alt="image" src="https://github.com/user-attachments/assets/62abdd36-e8c9-4c0b-b743-da9d5b85fa70"/></p>
<h2 id="24-explanation-of-the-code">2.4 Explanation of the Code</h2>
<ul>
<li><strong>lorentz_force()</strong>: This function computes the Lorentz force acting on the particle at each step, considering both the electric and magnetic fields. The force is calculated using the formula:</li>
</ul>
<p>$$
  \mathbf{F} = q (\mathbf{E} + \mathbf{v} \times \mathbf{B})
  $$</p>
<p>where:
  - <span class="arithmatex">\(q\)</span> is the charge of the particle,
  - <span class="arithmatex">\(\mathbf{E}\)</span> is the electric field,
  - <span class="arithmatex">\(\mathbf{v}\)</span> is the velocity of the particle,
  - <span class="arithmatex">\(\mathbf{B}\)</span> is the magnetic field.</p>
<ul>
<li>
<p><strong>update_position_velocity()</strong>: Using Euler's method, this function updates the particle's position and velocity at each time step. The particle's new position is calculated by adding the product of the velocity and the time step (<span class="arithmatex">\(\mathbf{r}_{\text{new}} = \mathbf{r} + \mathbf{v} \cdot \Delta t\)</span>), while the velocity is updated based on the acceleration, which is derived from the Lorentz force.</p>
</li>
<li>
<p><strong>Initial Conditions</strong>: The particle starts at the origin (position <span class="arithmatex">\(\mathbf{r_0} = [0, 0, 0]\)</span>) with an initial velocity along the x-axis (<span class="arithmatex">\(\mathbf{v_0} = [1 \times 10^5, 0, 0]\)</span>). The magnetic field is set along the z-axis (<span class="arithmatex">\(\mathbf{B} = [0, 0, 1]\)</span>), and the electric field is zero for the magnetic-only case.</p>
</li>
<li>
<p><strong>Trajectory Simulation</strong>: The loop iterates over a predefined number of time steps. At each step, the position and velocity are updated using the Lorentz force and Euler's method. This allows us to track the particle's motion under the influence of the fields.</p>
</li>
<li>
<p><strong>Plotting</strong>: The final trajectory is plotted in 3D space using Matplotlib. The plot visualizes the path of the particle, showing its movement over time in the magnetic field.</p>
</li>
</ul>
<h2 id="25-parameter-exploration">2.5 Parameter Exploration</h2>
<p>To explore the effects of different parameters, we can modify:</p>
<ul>
<li>
<p><strong>Field Strengths (<span class="arithmatex">\(B\)</span> and <span class="arithmatex">\(E\)</span>)</strong>: Changing the magnetic or electric field strengths alters the particle's trajectory. A stronger magnetic field results in a tighter circular path, while a stronger electric field can influence the particle's acceleration and velocity.</p>
</li>
<li>
<p><strong>Initial Velocity (<span class="arithmatex">\(v_0\)</span>)</strong>: The initial velocity direction and magnitude determine the radius of the circular path in the magnetic field. If both electric and magnetic fields are present, the particle will follow a helical motion with the pitch of the helix determined by the relative strengths of the fields and the particle's velocity.</p>
</li>
<li>
<p><strong>Charge and Mass (<span class="arithmatex">\(q\)</span> and <span class="arithmatex">\(m\)</span>)</strong>: The charge and mass of the particle influence the curvature of the path. Heavier particles (greater mass) have a larger radius of curvature, while lighter particles move more quickly in response to the Lorentz force. The charge also affects the direction of motion, with positively and negatively charged particles moving in opposite directions in the presence of a magnetic field.</p>
</li>
</ul>
<h2 id="26-visualization">2.6 Visualization</h2>
<p>The simulation can be visualized by plotting the particle's trajectory in 2D or 3D, as shown in the code above. By varying the field strengths and initial conditions, we can observe different types of motion:</p>
<ul>
<li>
<p><strong>Circular motion</strong>: A result of only the magnetic field. The particle moves in a circle with a radius determined by the particle's velocity and the magnetic field strength.</p>
</li>
<li>
<p><strong>Helical motion</strong>: A result of both electric and magnetic fields. The particle moves in a helix, with the pitch of the helix determined by the relative strengths of the fields and the particle's velocity.</p>
</li>
<li>
<p><strong>Drift motion</strong>: Occurs when the electric and magnetic fields are crossed. The particle exhibits motion along a straight path with a constant drift velocity in the direction of the electric field.</p>
</li>
</ul>
<h2 id="3-results">3. Results</h2>
<p>Running the simulation for various initial conditions and field configurations will produce the following observations:</p>
<ul>
<li>
<p>In a <strong>uniform magnetic field</strong>, the particle will move in a circular trajectory, with the radius determined by the particle's velocity and the magnetic field strength.</p>
</li>
<li>
<p>When both <strong>electric and magnetic fields</strong> are present, the particle will follow a helical path, with the pitch of the helix determined by the relative strengths of the fields and the particle's velocity.</p>
</li>
<li>
<p>In the case of <strong>crossed electric and magnetic fields</strong>, the particle exhibits drift motion, where the velocity components in the electric and magnetic directions result in motion along a straight path with constant drift velocity.</p>
</li>
</ul>
<h2 id="4-conclusion">4. Conclusion</h2>
<p>This simulation provides an intuitive understanding of the effects of the Lorentz force on charged particles. By varying the parameters and visualizing the resulting trajectories, we gain insight into the fundamental principles that govern particle motion in electric and magnetic fields. These principles have practical applications in systems such as particle accelerators, plasma confinement, and mass spectrometers.</p>
<p>The simulation also highlights key phenomena such as:</p>
<ul>
<li><strong>Larmor radius</strong>: The radius of the circular motion of a charged particle in a magnetic field.</li>
<li><strong>Drift velocity</strong>: The velocity of the particle along the direction of the crossed fields.</li>
</ul>
<p>This hands-on approach to the Lorentz force can be extended to more complex scenarios, such as non-uniform magnetic fields, and can be adapted for use in real-world systems.</p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="Problem 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../5%20Circuits/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../5%20Circuits/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
